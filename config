#!/usr/bin/env nu
# -*- mode: nushell -*-

def "main wezterm" [] {
  cp base/wezterm.lua ~/.config/wezterm
}

def "main nushell" [] {
  cp base/*.nu ~/.config/nushell
  cp base/starship.toml ~/.config
}

def "main fish" [] {
  cp base/config.fish ~/.config/fish
  cp base/starship.toml ~/.config
}

def "main emacs" [--install (-i)] {
  cp base/*.el ~/.config/doom
  if $install {
    let dir = ("~/.config/emacs" | path expand)
    let backup = ("~/.config/emacs2" | path expand)
    if ($dir | path exists) {
      rm --verbose --recursive --force $backup
      mv --verbose $dir $backup
      git clone --depth 1 https://github.com/doomemacs/doomemacs $dir
      doom install
      doom sync
      # doom upgrade
    }
  }
}

def "main git" [] {
  cpv base/sshconfig ~/.ssh/config
  source base/gitconfig
}

def "main i3" [] {
  let host = $"# (hostname): "
  "i3/i3config" | open | str replace --all $host "" | save -f ~/.config/i3/config
  cp i3/i3status.toml ~/.config/i3status-rust/config.toml
  cp i3/roficonfig.rasi ~/.config/rofi/config.rasi
}

def "main zathura" [] {
  cp apps/zathurarc ~/.config/zathura
}

def main [] {

}

# def main [...targets: string, --install (-i)] {
#   for target in $targets {
#     match $target {
#       "wezterm" => { config-wezterm }
#       "nushell" => { config-nushell }
#       "fish" => { config-fish }
#       "emacs" => { config-emacs $install }
#       "git" => { config-git }
#       _ => {
#         print --stderr $"error: unknown target: ($target)"
#         exit 1
#       }
#     }
#   }
# }
